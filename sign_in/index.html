<!DOCTYPE html>
<html lang="en">
	<!--begin::Head-->
	<head><base href="../"/>
		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZVP2L67128"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());
		  gtag('config', 'G-ZVP2L67128');
		</script>
		<title>AISMA &bull; Sign Up</title>
		<meta charset="utf-8" />
		<meta name="description" content="Sign up" />
		<meta name="keywords" content="AI Social Media Assistant" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta property="og:locale" content="en_US" />
		<link rel="shortcut icon" href="https://bizcom.wr.io/assets/media/logos/favicon.ico" />
		<!--begin::Fonts-->
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,400,500,600,700" />
		<!--end::Fonts-->
		<!--begin::Global Stylesheets Bundle(used by all pages)-->
		<link href="https://bizcom.wr.io/assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
		<link href="https://bizcom.wr.io/assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
		<!--end::Global Stylesheets Bundle-->
	</head>
	<!--end::Head-->
	<!--begin::Body-->
	<body data-kt-name="good" id="kt_body" class="auth-bg app-blank">
		<!--begin::Theme mode setup on page load-->
		<script>var defaultThemeMode = "light"; var themeMode; if ( document.documentElement ) { if ( document.documentElement.hasAttribute("data-theme-mode")) { themeMode = document.documentElement.getAttribute("data-theme-mode"); } else { if ( localStorage.getItem("data-theme") !== null ) { themeMode = localStorage.getItem("data-theme"); } else { themeMode = defaultThemeMode; } } if (themeMode === "system") { themeMode = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light"; } document.documentElement.setAttribute("data-theme", themeMode); }</script>
		<!--end::Theme mode setup on page load-->
		<!--begin::Root-->
		<div class="d-flex flex-column flex-root" id="kt_app_root">
			<!--begin::Authentication - Sign-in -->
			<div class="d-flex flex-column flex-lg-row flex-column-fluid">
				<!--begin::Aside-->
				<div class="d-flex flex-column flex-lg-row-auto bg-primary w-xl-600px positon-xl-relative">
					<!--begin::Wrapper-->
					<div class="d-flex flex-column position-xl-fixed top-0 bottom-0 w-xl-600px scroll-y">
						<!--begin::Header-->
						<div class="d-flex flex-row-fluid flex-center flex-column text-center p-10 pt-lg-20">
							<a href="./" class="py-9">
								<p class="fw-semibold fs-2 text-white"><i class="bi bi-arrow-left text-white"></i> Back</p>
							</a>
							<!--begin::Title-->
							<h1 class="fw-bold text-white fs-2qx pb-5 pb-md-10">AI Social Media Assistant</h1>
							<!--end::Title-->
							<!--begin::Description-->
							<p class="fw-semibold fs-2 text-white">An AI-powered service to 10x enhance your networking building on Twitter</p>
							<!--end::Description-->
								<!--begin::Logo-->
								<a href="http://bizcom.wr.io/" class="py-9 pt-lg-20">
									<p class="fw-semibold fs-2 text-white">Powered by</p>
									<img alt="Logo" src="http://bizcom.wr.io/assets/media/logos/default.png" class="h-40px" />
								</a>
								<!--end::Logo-->
						</div>
						<!--end::Header-->
					</div>
					<!--end::Wrapper-->
				</div>
				<!--begin::Aside-->
				<!--begin::Body-->
				<div class="d-flex flex-column flex-lg-row-fluid py-10">
					<!--begin::Content-->
					<div class="d-flex flex-center flex-column flex-column-fluid">
						<!--begin::Wrapper-->
						<div class="w-lg-500px p-10 p-lg-15 mx-auto">
							<!--begin::Form-->

							<form class="form w-100" novalidate="novalidate" id="kt_sign_in_form" action="#">
								<!--begin::Heading-->
								<div class="text-center mb-10">
									<!--begin::Title-->
									<h1 class="text-dark mb-3">Sign In</h1>
									<!--end::Title-->
								</div>
								<!--begin::Heading-->
								<div class="text-center mb-10">
									<!--begin::Link-->
									<div class="text-gray-400 fw-semibold fs-4">Need an account?
									<a href="../sign_up" class="link-primary fw-bold">Sign up</a></div>
									<!--end::Link-->
								</div>
								<!--begin::Heading-->
								<!--begin::Input group-->
								<div class="fv-row mb-10">
									<!--begin::Label-->
									<label class="form-label fs-6 fw-bold text-dark">Email</label>
									<!--end::Label-->
									<!--begin::Input-->
									<input class="form-control form-control-lg form-control-solid" type="text" name="email" autocomplete="on" />
									<!--end::Input-->
								</div>
								<!--end::Input group-->
								<!--begin::Input group-->
								<div class="fv-row mb-10">
									<!--begin::Wrapper-->
									<div class="d-flex flex-stack mb-2">
										<!--begin::Label-->
										<label class="form-label fw-bold text-dark fs-6 mb-0">Password</label>
										<!--end::Label-->
										<!--begin::Link-->
										<a href="mailto:info@wr.io?subject=Forgot Password" class="link-primary fs-6 fw-bold" target="_blank">Forgot Password ?</a>
										<!--end::Link-->
									</div>
									<!--end::Wrapper-->
									<!--begin::Input-->
									<input class="form-control form-control-lg form-control-solid" type="password" name="password" autocomplete="off" />
									<!--end::Input-->
								</div>
								<!--end::Input group-->
								<!--begin::Actions-->
								<div class="text-center">
									<!--begin::Submit button-->
									<button id="kt_submit" type="submit" class="btn btn-lg btn-primary w-100 mb-5">
										<span class="indicator-label">Submit</span>
										<span class="indicator-progress">Please wait...
										<span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
									</button>
								</div>
								<div id="error-message" class="text-center fv-plugins-message-container invalid-feedback" style="display:none">Wrong email or password. Try again</div>
								<!--end::Actions-->
							</form>
							<!--end::Form-->
						</div>
						<!--end::Wrapper-->
					</div>
					<!--end::Content-->
					<!--begin::Footer-->
					<div class="d-flex flex-center flex-wrap fs-6 p-5 pb-0">
						<!--begin::Links-->
						<div class="d-flex flex-center fw-semibold fs-6">
							<a href="../" class="text-muted text-hover-primary px-2">About</a>
							<a href="mailto:info@wr.io" class="text-muted text-hover-primary px-2" target="_blank">Support</a>
						</div>
						<!--end::Links-->
					</div>
					<div class="d-flex flex-center flex-wrap fs-6 p-5 pb-0">
						<!--begin::Links-->
						<div class="d-flex flex-center fw-semibold fs-6">
							<span class="text-muted fw-semibold me-1">2023Â©</span>
							<a href="https://wr.io" target="_blank" class="text-muted text-hover-primary">WRIO Ltd</a>
						</div>
						<!--end::Links-->
					</div>
					<!--end::Footer-->
				</div>
				<!--end::Body-->
			</div>
			<!--end::Authentication - Sign-in-->
		</div>
		<!--end::Root-->
		<!--begin::Javascript-->
		<script>var hostUrl = "";</script>
		<!--begin::Global Javascript Bundle(used by all pages)-->
		<script src="https://bizcom.wr.io/assets/plugins/global/plugins.bundle.js"></script>
		<script src="https://bizcom.wr.io/assets/js/scripts.bundle.js"></script>
		<!--end::Global Javascript Bundle-->
		<!--begin::Custom Javascript(used by this page)
		<script src="https://bizcom.wr.io/assets/js/custom/authentication/sign-in/general.js"></script>-->

		<script>
		function checkCredentials(email, password) {
			return fetch(`https://aisma-signin.wrio.workers.dev/?email=${email}&password=${password}`)
				.then(response => response.text())
				.then(data => {
					if (data !== 'NOT_FOUND') {
						return data; // Return the ID of the matching record
					} else {
						return null; // No matching record found
					}
				});
			}

			function handleFormSubmit(event) {
			event.preventDefault();

			const submitButton = document.getElementById('kt_submit');
			const indicatorLabel = submitButton.querySelector('.indicator-label');
			const indicatorProgress = submitButton.querySelector('.indicator-progress');
			// Change the text to "Saving" and show the spinner
			indicatorLabel.textContent = '';
			indicatorProgress.style.display = 'inline-block';

			const emailInput = document.getElementById('kt_sign_in_form').elements['email'];
			const passwordInput = document.getElementById('kt_sign_in_form').elements['password'];

			const email = emailInput.value;
			const password = passwordInput.value;

			checkCredentials(email, password)
				.then(data => {
					if (data) {
						// Split the data into recordId and extensionId
						const [recordId, extensionId] = data.split(',');
						// Store them in localStorage
						window.localStorage.setItem('emailRecordId', recordId);
						window.localStorage.setItem('extensionId', extensionId); // Store the extensionId
						// Redirect to the dashboard page
						window.location.href = 'dashboard';
					} else {
						// No matching record found, show an error message
						const errorMessage = document.getElementById('error-message');
						errorMessage.style.display = 'block';
						indicatorLabel.textContent = 'Submit';
						indicatorProgress.style.display = 'none';

						// Fade away the error message after 2 seconds
						setTimeout(() => {
							errorMessage.style.opacity = '0';
							setTimeout(() => {
								errorMessage.style.display = 'none';
								errorMessage.style.opacity = '1';
							}, 500);
						}, 2000);
					}
				})
				.catch(err => {
					console.error('Error:', err);
				});
			}

			// Add event listener to form submission
			const signInForm = document.getElementById('kt_sign_in_form');
			signInForm.addEventListener('submit', handleFormSubmit);

		</script>

		<!--end::Custom Javascript-->
		<!--end::Javascript-->
	</body>
	<!--end::Body-->
</html>
